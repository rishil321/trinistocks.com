{% extends "base.html" %}
{% load django_tables2 %}
{% load static %}

    {% block sidepanelcontents %}
    <div class="panel-block is-size-1-touch">
        <label class="panellabel" for="date">Trading date</label>
        <input type="date" class="custom-date-selector" value="{{ selecteddateparsed }}" id="date" name="date">
    </div>
    <div class="panel-block is-size-1-touch">
        <input type="hidden" value="1" name="wastradedtoday"></input>
        <input type="hidden" value="-valuetraded" name="sort"></input>
        <input type="submit" name="configure_button" class="custom-red-button" onclick="location.href='{% url 'stocks:dailytradingsummary' %}" value="Search"/>
    <div>
    {% endblock sidepanelcontents %}

    {% block mainblock %}
    <h1 style="" class="" id="charttitle">Stocks Traded on the TTSE on {{ selecteddate }}</h1>
    <!-- Chart -->
    <br>
    <div id="chartdiv" class="chart-div" style="">
    </div>
    <br>
    <div class="buttons is-centered ">
        <a class="button export-csv-button" id="exportcsvbutton" href="{% export_url "csv" %}">Export as CSV</a>
    </div>
    <div class="is-clearfix clearfix"></div>    
    <div class="tablediv">
        {% render_table table %}
    </div>
    {% endblock mainblock %}

    {% block chartjs %}
    {{ graphvaluetraded|json_script:"graphvaluetraded" }}
    {{ graphsymbols|json_script:"graphsymbols" }}
    <script>
    var jssymbols = JSON.parse(document.getElementById('graphsymbols').textContent);
    var valuetraded = JSON.parse(document.getElementById('graphvaluetraded').textContent);
    var data = [
        {
            x: jssymbols,
            y: valuetraded,
            marker:{
                color: ['#ff3300','#ff5410','#ff6c22','#ff8134','#ff9347','#ffa45b','#ffb470','#ffc387','#ffd29f','#ffd29f','#ffd499']
            },
            type: 'bar'
        }
    ];
    var layout = {
        xaxis: {
            title: 'Ticker',
            titlefont: {
            size: 20
            },
            showticklabels: true,
            tickangle: 'auto',
            tickfont: {
            size: 16
            },
            exponentformat: 'SI',
            showexponent: 'all'
        },
        yaxis: {
            title: 'Dollar Volume Traded ($)',
            titlefont: {
            size: 20
            },
            showticklabels: true,
            tickangle: 45,
            tickfont: {
            size: 16
            },
            exponentformat: 'SI',
            showexponent: 'all'
        }
        };
    Plotly.newPlot('chartdiv', data, layout);
    </script>
    {% endblock chartjs %}
    <!-- END MAIN -->
    
    <!--Javascript-->
    {% block activepagetoggle %}
    $("#dailytradingsummarylink").toggleClass("has-background-red");
    {% endblock %}