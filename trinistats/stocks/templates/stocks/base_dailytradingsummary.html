{% extends "base.html" %}
{% load django_tables2 %}
{% load static %}

    {% block headerscripts%}
    <!-- JSON-LD markup generated by Google Structured Data Markup Helper. -->
    <script type="application/ld+json">
    {
    "@context" : "http://schema.org",
    "@type" : "Dataset",
    "name" : "Stocks Traded on the TTSE",
    "description" : "Latest daily stock trading data from the Trinidad and Tobago Stock Exchange (TTSE)"
    }
    </script>
    {% endblock headerscripts%}

    {% block description %}"Daily volume,price changes etc. for stocks traded on the Trinidad and Tobago Stock Exchange (TTSE),displayed in a bar chart"
    {% endblock description %}

    {% block title %}trinistats | Stocks | Daily Stock Trading Data for the Trinidad and Tobago Stock Exchange (TTSE)
    {% endblock title %}

    {% block sidepanelcontents %}
    {% endblock sidepanelcontents %}

    <form method="get">
    <div class="columns is-centered is-multiline is-vcentered" id="customizationbar" style="text-align:center;">
        {% block customizationbar%}
        <div class="column">
            <label class="" for="date">Trading date</label>
            <input type="date" class="custom-date-selector" value="{{ selected_date_parsed }}" id="date" name="date">
        </div>
        <div class="column">
            <input type="hidden" value="1" name="was_traded_today"></input>
            <input type="hidden" value="-value_traded" name="sort"></input>
            <input type="submit" name="configure_button" class="custom-red-button" onclick="location.href='{% url 'stocks:dailytradingsummary' %}" value="Search"/>
        </div>
        {% endblock customizationbar%}
    </div>
    </form>

    {% block mainblock %}
    <h1 style="" class="" id="charttitle">Stocks Traded on the TTSE on {{ selected_date }}</h1>
    <!-- Chart -->
    <div id="chartdiv" class="chart-div" style="">
    </div>
    <br>
    <div class="buttons is-centered ">
        <a class="button export-csv-button" id="exportcsvbutton" href="{% export_url "csv" %}">Export as CSV</a>
    </div>
    <div class="is-clearfix clearfix"></div>    
    <div class="tablediv_scroll">
        {% render_table table %}
    </div>
    {% endblock mainblock %}

    {% block chartjs %}
    {{ graph_value_traded|json_script:"graph_value_traded" }}
    {{ graph_symbols|json_script:"graph_symbols" }}
    <script>
    var js_symbols = JSON.parse(document.getElementById('graph_symbols').textContent);
    var value_traded = JSON.parse(document.getElementById('graph_value_traded').textContent);
    var data = [
        {
            x: js_symbols,
            y: value_traded,
            marker:{
                color: ['#ff3300','#ff5410','#ff6c22','#ff8134','#ff9347','#ffa45b','#ffb470','#ffc387','#ffd29f','#ffd29f','#ffd499']
            },
            type: 'bar'
        }
    ];
    var layout = {
        xaxis: {
            automargin: true,
            title: {text:'Ticker Symbol',
            standoff: 20
            },
            titlefont: {
            size: 20
            },
            showticklabels: true,
            tickangle: 'auto',
            tickfont: {
            size: 14
            },
            exponentformat: 'SI',
            showexponent: 'all'
        },
        yaxis: {
            title: 'Dollar Volume Traded ($)',
            titlefont: {
            size: 20
            },
            showticklabels: true,
            tickangle: 45,
            tickfont: {
            size: 16
            },
            exponentformat: 'SI',
            showexponent: 'all'
        }
        };
    Plotly.newPlot('chartdiv', data, layout);
    </script>
    {% endblock chartjs %}
    <!-- END MAIN -->
    
    <!--Javascript-->
    {% block activepagetoggle %}
    $("#dailytradingsummarylink").toggleClass("has-background-red");
    {% endblock %}